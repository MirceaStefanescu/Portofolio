apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-init
  namespace: predictive-analytics
data:
  init.sql: |
    CREATE TABLE IF NOT EXISTS predictions (
      id SERIAL PRIMARY KEY,
      event_type TEXT NOT NULL,
      window_start TIMESTAMP NOT NULL,
      window_end TIMESTAMP NOT NULL,
      event_count BIGINT NOT NULL,
      avg_value DOUBLE PRECISION NOT NULL,
      prediction_score DOUBLE PRECISION NOT NULL,
      created_at TIMESTAMP NOT NULL DEFAULT NOW()
    );

    CREATE INDEX IF NOT EXISTS idx_predictions_event_type ON predictions(event_type);
    CREATE INDEX IF NOT EXISTS idx_predictions_window_end ON predictions(window_end);
